{% extends "base.html" %}
{% load static %}

{% block title %}Login | InternLink{% endblock %}
{% block body_class %}auth-body{% endblock %}

{% block content %}
  <div class="auth-shell">
    <aside class="auth-left">
      <a href="{% url 'landing' %}" class="auth-logo-link" aria-label="Back to InternLink home">
        <img class="auth-left-logo"
             src="{% static 'img/internlink_logo_white.png' %}"
             alt="InternLink">
        <span class="auth-logo-hint">Back to home</span>
      </a>
    </aside>

    <main class="auth-right auth-right-center">
      <div class="auth-card">

        <h2>Log In</h2>
        <p class="bottom-text auth-subtitle">
          Welcome back. Continue to your InternLink account.
        </p>

        {% if error %}
          <div class="form-error">{{ error }}</div>
        {% endif %}

        <form method="post" class="card-soft" novalidate>
          {% csrf_token %}

          <div class="input-wrap">
            <label>Email / Phone / Username</label>
            <input
              type="text"
              name="identifier"
              required
              autocomplete="username"
              placeholder="you@example.com or 98XXXXXXXX"
              value="{{ form.identifier.value|default_if_none:'' }}"
            >
            {% if form.identifier.errors %}
              <div class="field-err">{{ form.identifier.errors.0 }}</div>
            {% endif %}
          </div>

          <div class="input-wrap ui-gap-md">
            <label>Password</label>

            <div class="input-inline">
              <input
                id="passwordInput"
                type="password"
                name="password"
                required
                autocomplete="current-password"
                placeholder="Enter your password"
              >
              <button
                type="button"
                class="pw-toggle"
                id="togglePwBtn"
                aria-pressed="false"
                aria-label="Show password"
              >
                Show
              </button>
            </div>

            {% if form.password.errors %}
              <div class="field-err">{{ form.password.errors.0 }}</div>
            {% endif %}
          </div>

          <div class="auth-row">
            <label class="check">
              <input type="checkbox" name="remember_me">
              Remember me
            </label>

            <a class="auth-link" href="#">Forgot password?</a>
          </div>

          <div class="auth-actions">
            <button class="btn-primary" type="submit">Log In</button>
          </div>

          <p class="auth-helper">
            Didn’t verify your email?
            <a href="{% url 'resend_email_code' %}?email={{ form.identifier.value|default_if_none:''|urlencode }}">
              Resend verification code
            </a>
          </p>

          <div class="auth-divider"></div>

          <p class="bottom-text auth-footer">
            Don’t have an account? <a href="{% url 'register' %}">Create one</a>
          </p>
        </form>

      </div>
    </main>
  </div>
{% endblock %}

{% block extra_js %}
<script>
  (function () {
    const input = document.getElementById("passwordInput");
    const btn = document.getElementById("togglePwBtn");
    if (!input || !btn) return;

    btn.addEventListener("click", function () {
      const showing = input.type === "text";
      input.type = showing ? "password" : "text";
      btn.textContent = showing ? "Show" : "Hide";
      btn.setAttribute("aria-pressed", showing ? "false" : "true");
      btn.setAttribute("aria-label", showing ? "Show password" : "Hide password");
    });
  })();
</script>
{% endblock %}
